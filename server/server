from flask import Flask, request, jsonify
from Server import Util
from Util import classify_image

app = Flask(__name__)

@app.route('/classify_image', methods=['POST'])
def classify_image():
    try:
        image_data = request.files['image'].read()
        response = jsonify(Util.classify_image(image_data))
        response.headers.add('Access-Control-Allow-Origin', '*')
        return response
    except Exception as e:
        error_message = f"An error occurred: {str(e)}"
        return jsonify({"error": error_message}), 500

if __name__ == '__main__':
    Util.load_save_artifacts()
    app.run(port=5000)
